<div class="task-form-container">
  <div class="task-form-card">
    <h2>{{ isEditMode ? 'Edit Task' : 'Create New Task' }}</h2>

    <div *ngIf="loading" class="loading-spinner">
      <div class="spinner"></div>
      <p>Loading task...</p>
    </div>

    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>

    <div *ngIf="success" class="alert alert-success">
      {{ success }}
    </div>

    <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" *ngIf="!loading">
      <div class="form-group">
        <label for="title">Title</label>
        <input 
          type="text" 
          formControlName="title" 
          class="form-control" 
          [ngClass]="{ 'is-invalid': f['title'].touched && f['title'].errors }" 
        />
        <div *ngIf="f['title'].touched && f['title'].errors" class="invalid-feedback">
          <div *ngIf="f['title'].errors['required']">Title is required</div>
          <div *ngIf="f['title'].errors['maxlength']">Title cannot exceed 100 characters</div>
        </div>
      </div>
      
      <div class="form-group">
        <label for="description">Description</label>
        <textarea 
          formControlName="description" 
          class="form-control" 
          rows="4"
          [ngClass]="{ 'is-invalid': f['description'].touched && f['description'].errors }"
        ></textarea>
        <div *ngIf="f['description'].touched && f['description'].errors" class="invalid-feedback">
          <div *ngIf="f['description'].errors['maxlength']">Description cannot exceed 500 characters</div>
        </div>
      </div>

      <div class="form-group form-check">
        <input 
          type="checkbox" 
          formControlName="completed" 
          class="form-check-input" 
          id="completed"
        />
        <label class="form-check-label" for="completed">Mark as completed</label>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-outline-secondary" (click)="cancel()">Cancel</button>
        <button type="submit" class="btn btn-primary" [disabled]="submitting">
          <span *ngIf="submitting" class="spinner-border spinner-border-sm mr-1"></span>
          {{ isEditMode ? 'Update Task' : 'Create Task' }}
        </button>
      </div>
    </form>
  </div>
</div>